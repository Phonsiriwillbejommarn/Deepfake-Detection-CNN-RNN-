# Deepfake-Detection-CNN-RNN-
1. การจัดเตรียมโครงสร้างไฟล์
โครงสร้างควรมีลักษณะคล้ายกับนี้:

Deepfake-Detection-CNN-RNN-/
├── run_all.sh
├── README.md
├── src/
│   ├── model_varlen.py
│   ├── train_varlen.py
│   ├── predict_varlen.py
│   └── sequence_generator_varlen.py
├── data/
│   ├── real/  (โฟลเดอร์นี้จะใช้สำหรับใส่วิดีโอจริงของคุณ)
│   └── fake/  (โฟลเดอร์นี้จะใช้สำหรับใส่วิดีโอ deepfake ของคุณ)
└── checkpoints/
    └── varlen_best.h5  (ไฟล์นี้จะถูกสร้างขึ้นหลังจากการฝึกโมเดล)
    
ให้สร้างโฟลเดอร์ data/real และ data/fake ขึ้นมา แล้วนำไฟล์วิดีโอที่คุณต้องการใช้ในการฝึกโมเดลมาใส่ไว้ในโฟลเดอร์เหล่านี้

3. การติดตั้งโปรแกรมและไลบรารีที่จำเป็น

คุณต้องติดตั้งโปรแกรมต่อไปนี้ก่อนรันสคริปต์:

Python: ติดตั้ง Python 3.7 หรือใหม่กว่า

TensorFlow: ติดตั้ง TensorFlow เวอร์ชันล่าสุด

OpenCV: ติดตั้งไลบรารี OpenCV สำหรับการประมวลผลวิดีโอและภาพ

ไลบรารีอื่นๆ: ติดตั้งไลบรารีที่จำเป็นอื่นๆ เช่น NumPy

คุณสามารถใช้คำสั่ง pip เพื่อติดตั้งไลบรารีเหล่านี้ได้:

Bash
pip install tensorflow numpy opencv-python Pillow

3. การรันสคริปต์เพื่อฝึกโมเดล

ไฟล์ run_all.sh เป็นสคริปต์หลักที่จะจัดการทุกอย่างให้คุณโดยอัตโนมัติ

เปิด Terminal หรือ Command Prompt ขึ้นมา จากนั้นให้ไปยังโฟลเดอร์หลักของโปรเจกต์ (Deepfake-Detection-CNN-RNN-) แล้วรันคำสั่งนี้:

Bash
sh run_all.sh

สคริปต์นี้จะทำสองขั้นตอนหลักๆ:

การเตรียมข้อมูล: สคริปต์จะอ่านไฟล์วิดีโอจากโฟลเดอร์ data/real และ data/fake เพื่อสกัดเฟรมภาพออกมา จากนั้นจะแบ่งข้อมูลออกเป็นชุดฝึก (train) และชุดตรวจสอบ (validation) และสร้างไฟล์ train_list.txt และ val_list.txt ขึ้นมา

การฝึกโมเดล: สคริปต์จะใช้ไฟล์รายการข้อมูลที่สร้างขึ้นเพื่อฝึกโมเดล CNN-RNN ที่รองรับวิดีโอที่มีความยาวต่างกัน เมื่อการฝึกเสร็จสิ้น โมเดลที่ดีที่สุดจะถูกบันทึกไว้ในไฟล์ checkpoints/varlen_best.h5

4. การใช้โมเดลเพื่อทำนายผล

เมื่อโมเดลถูกฝึกเสร็จแล้ว คุณสามารถใช้สคริปต์ src/predict_varlen.py เพื่อตรวจสอบวิดีโอใหม่ได้

เปิด Terminal หรือ Command Prompt และไปที่โฟลเดอร์ src

Bash
cd src
จากนั้นรันคำสั่งนี้เพื่อทำนายผลวิดีโอของคุณ (แทนที่ /path/to/your/video.mp4 ด้วยเส้นทางของไฟล์วิดีโอจริงที่คุณต้องการตรวจสอบ):

Bash
python predict_varlen.py --model ../checkpoints/varlen_best.h5 --video /path/to/your/video.mp4
--model : ระบุตำแหน่งของไฟล์โมเดลที่ผ่านการฝึกแล้ว (varlen_best.h5)

--video : ระบุตำแหน่งของไฟล์วิดีโอที่คุณต้องการทำนาย

สคริปต์จะแสดงผลลัพธ์ออกมาเป็นค่าความน่าจะเป็น (probability) และผลการทำนายว่าเป็นวิดีโอจริง (0) หรือ Deepfake (1)
